<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="default-src * data:; font-src data: *; script-src 'self' 'unsafe-inline' 'unsafe-eval' *; style-src 'self' 'unsafe-inline' *; img-src * data: 'unsafe-inline'">
    <!--<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Fidele Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template,
    Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design" />-->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="./cordova.js"></script>

    <link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
    <link href="css/fa-fa-icons.min.css" rel="stylesheet" />
    <link href="css/w3.css" rel="stylesheet" />
    <link href="css/jqmCss.css" rel="stylesheet" />
    <link href="css/StyleSheet.css" rel="stylesheet" />
    <link href="dist/sweetalert/sweetalert.css" rel="stylesheet" charset="utf-8" />

    <script src="dist/sweetalert/sweetalert-dev.js" charset="utf-8"> </script>
    <script src="js/jquery.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jqm.js"></script>

    <script src="js/master.js"></script>
    <!--font-Awesome-->
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!--//font-Awesome-->
    <script>
        // קונסטנטות
        const generic = GENERAL.genericWebServerAddress;
        const user = GENERAL.USER;
    </script>

    <script>

        //טעימה
        $(window).load(function () {
            setTimeout(() =>
                $(".loader").fadeOut("slow"), 500);
        })


        //שליפת נתוני פרופיל ממסד הנתונים
        $(document).ready(function () {
            var U = user.userID();
            $.ajax({
                dataType: "json",
                url: generic + "GetUserDetailsMobile",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ userId: U }),
                success: function (data) {
                    var UserId = JSON.parse(data.d);

                    if (UserId != "") {
                        $("#UserFirstName").text(UserId.FirstName);
                        $("#UserLastName").text(UserId.LastName);
                        $("#UserId").text(UserId.UserId);
                        $("#UserAddress").text(UserId.Address);
                        $("#UserMail").text(UserId.Mail);
                        $("#UserScore").text(UserId.Rank.RankDesc);
                        $("#UserNum").text(UserId.Number);

                        $("#UserFirstNameInp").val(UserId.FirstName);
                        $("#UserLastNameInp").val(UserId.LastName);
                        $("#UserIdInp").val(UserId.UserId);
                        $("#UserAddressInp").val(UserId.Address);
                        $("#UserMailInp").val(UserId.Mail);
                        $("#UserScoreInp").val(UserId.Rank.RankDesc);
                        $("#UserNumInp").val(UserId.Number);

                        $("#UserScoreInp").attr('disabled', 'disabled');
                        $("#UserIdInp").attr('disabled', 'disabled');
                        $("#UserMailInp").attr('disabled', 'disabled');

                    }
                },
                error: function (err) { }
            });

            //גלילת תפריט
            $("span.nav-list-it5").on("tap", function () {
                $("ul.nav-top-list1").slideToggle("slow", function () {
                    // Animation complete.
                });
            });

        });

        //העלמת כפתור פיקס כשמקלדת נפתחת
        $(document).ready(function () {
            var _originalSize = $(window).width() + $(window).height()
            $(window).resize(function () {
                if ($(window).width() + $(window).height() != _originalSize) {
                    $(".FixedButton").css("display", "none");
                }
                else {
                    $(".FixedButton").css("display", "block");
                }
            });
        });

        //שמור שינויים
        function SubmitChanges() {
            var U = user.userID();
            var first = $("#UserFirstNameInp").val();
            var last = $("#UserLastNameInp").val();
            var address = $("#UserAddressInp").val();
            var phone = $("#UserNumInp").val();

            $.ajax({
                dataType: "json",
                url: generic + "UpdateUser",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ userId: U, first: first, last: last, address: address, phone: phone }),
                success: function (data) {

                    var UserId = JSON.parse(data.d);
                    if (UserId == true) {
                        swal({
                            title: "איזה יופי..",
                            text: "הנתונים נשמרו בהצלחה. הינך מועבר חזרה לדף הבית",
                            type: "success",
                            confirmButtonText: "אישור"
                        })
                    }

                },
                error: function (err) { }
            });
        }

        //מעבר לעמוד המכרזים שהשתתפתי
        function ToProfile() {
            location.href = "app.html#profile";
        };

        //מעבר לעמוד המוצרים שלי
        function ToProducts() {
            location.href = "app.html#products";
        };

        //התנתקות
        function LogOut() {
            localStorage.removeItem("UserID");
            location.href = 'Login-Taramti.html'
        }
    </script>

</head>
<body>
    <div class="loader">
        <img id="LoadingImg" src="img/just_logo.png" />
    </div>
    <div class="pageBC" data-role="page" id="UserDetailsPage">
        <!--<img id="BkgroundImg" src="images/LONGLoginBackground.jpg" />-->
        <div id="MenuBarDiv" style="z-index:150;" class="navigation-1 navigation-5">

            <img id="LogoBidIt" src="images/LogoBidIt.png" />
            <div class="nav-left">
                <img onclick="location.href = 'app.html'" style="z-index:150" id="TaramtiLogo" src="images/LogoCircle.png" />
            </div>
            <div class="nav-right">
                <span class="nav-list-it5">
                    <i class="fa fa-bars"></i>
                </span>

                <ul class="nav-top-list nav-top-list1">
                    <li><a onclick="location.href = 'app.html'">דף הבית</a><label>|</label></li>
                    <li><a onclick="location.href = 'AddingAuction-Taramti.html'">הוספת מכרז</a><label>|</label></li>
                    <li><a onclick="location.href = 'appSettings.html#SearchAssoc'">פרטי עמותות</a><label>|</label></li>
                    <li><a onclick="location.href = 'userDetails.html'"><img class="MenuIconLeft" src="images/LeftArrow.png" />פרופיל משתמש</a><label>|</label></li>
                    <li><a onclick="location.href = 'appSettings.html#Settings'">הגדרות אפליקציה</a><label>|</label></li>
                    <li><a onclick="location.href='RegisterAssoc-Taramti.html'">הוספת עמותה</a><label>|</label></li>
                    <li><a onclick="LogOut()"> התנתק <i class="fa fa-sign-out"></i></a></li>
                    <!--<li><a class="active" href="#"><i class="fa fa-home"></i>Home</a><label>|</label></li>-->
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>

        <div class="Form" id="UserDetailsForm">

            <div id="EditUserBtn" class="RoundDivIcon">
                <a class="styleLink" href="#EditUserDetailsPage"><img class="NiceIcon" src="images/Edit_user_male1600.png" /></a>
                <h6 class="IconText">עריכה</h6>
            </div>

            <h2>דף פרטי משתמש   </h2>

            <div id="avatar" style="margin:0 auto"></div>

            <div class="divBtn" id="LeftBtn"><a onclick="ToProfile()">מכרזים שהשתתפתי</a></div>
            <div class="divBtn" id="RightBtn"><a onclick="ToProducts()">מכרזים שלי</a></div>

            <div>
                <h4>שם פרטי: &nbsp;</h4>
                <h5 id="UserFirstName"></h5>
            </div>

            <div>
                <h4>שם משפחה: &nbsp;</h4>
                <h5 id="UserLastName"></h5>
            </div>

            <div>
                <h4>תעודת זהות: &nbsp;</h4>
                <h5 id="UserId"></h5>
            </div>

            <div>
                <h4>כתובת: &nbsp;</h4>
                <h5 id="UserAddress"></h5>
            </div>

            <div>
                <h4>כתובת אימייל: <br /> </h4>
                <div id="UserMailDiv"><h5 id="UserMail"></h5></div>
            </div>

            <div>
                <h4>טלפון: &nbsp;</h4>
                <h5 id="UserNum"></h5>
            </div>

            <div>
                <h4>ניקוד: &nbsp;</h4>
                <h5 id="UserScore"></h5>
            </div>

            <div class="FixedButton">
                <div class="RoundDivfixed">
                    <div id="fixedCircle">
                        <a onclick="location.href = 'app.html'"><img src="images/circle-for-home.png" /></a>
                    </div>
                    <div id="fixedHome">
                        <a onclick="location.href = 'app.html'"><img src="images/Home1600.png" /></a>
                    </div>

                </div>
            </div>

        </div>

    </div>

    <!--דף עריכת נתונים-->
    <div class="pageBC" data-role="page" id="EditUserDetailsPage">
        <!--<img id="BkgroundImg" src="images/LONGLoginBackground.jpg" />-->
        <div id="MenuBarDiv" style="z-index:150;" class="navigation-1 navigation-5">

            <img id="LogoBidIt" src="images/LogoBidIt.png" />
            <div class="nav-left">
                <img onclick="location.href = 'app.html'" style="z-index:150" id="TaramtiLogo" src="images/LogoCircle.png" />
            </div>
            <div class="nav-right">
                <span class="nav-list-it5">
                    <i class="fa fa-bars"></i>
                </span>

                <ul class="nav-top-list nav-top-list1">
                    <li><a onclick="location.href = 'app.html'">דף הבית</a><label>|</label></li>
                    <li><a onclick="location.href = 'AddingAuction-Taramti.html'">הוספת מכרז</a><label>|</label></li>
                    <li><a onclick="location.href = 'appSettings.html#SearchAssoc'">פרטי עמותות</a><label>|</label></li>
                    <li><a onclick="location.href = 'userDetails.html'"><img class="MenuIconLeft" src="images/LeftArrow.png" />פרופיל משתמש</a><label>|</label></li>
                    <li><a onclick="location.href = 'appSettings.html#Settings'">הגדרות אפליקציה</a><label>|</label></li>
                    <li><a onclick="location.href='RegisterAssoc-Taramti.html'">הוספת עמותה</a><label>|</label></li>
                    <li><a onclick="LogOut()"> התנתק <i class="fa fa-sign-out"></i></a></li>

                    <!--<li><a class="active" href="#"><i class="fa fa-home"></i>Home</a><label>|</label></li>-->
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>

        <div class="Form" id="EditUserDetailsForm">

            <h2>דף עריכת משתמש   </h2>

            <div id="avatar" style="margin:0 auto"></div>
            <h4>שם פרטי: </h4>
            <input type="text" id="UserFirstNameInp" />
            <h4>שם משפחה: </h4>
            <input type="text" id="UserLastNameInp" />
            <h4>תעודת זהות: </h4>
            <input type="text" id="UserIdInp" />
            <h4>כתובת: </h4>
            <input type="text" id="UserAddressInp" />
            <h4>כתובת אימייל: </h4>
            <input type="text" id="UserMailInp" />
            <h4>טלפון: </h4>
            <input type="text" id="UserNumInp" />
            <h4>ניקוד: </h4>
            <input type="text" id="UserScoreInp" />

            <div class="button-1">
                <button type="button" id="UpdateUserbtn" onclick="AreYouSure()" class="btn-l btn-10" >שמירת נתונים</button>
            </div>

            <!--var ook = $('<a href="#ImSureDialog1" id="UpdateUserbtn" class="ui-btn ui-input-btn ui-corner-all ui-shadow" style="position:initial" data-transition="flip"> שמירת נתונים </a>');
            ook.appendTo("#EditUserDetailsForm");-->


            <div class="FixedButton">
                <div class="RoundDivfixed">
                    <div id="fixedCircle">
                        <a onclick="location.href = 'app.html'"><img src="images/circle-for-home.png" /></a>
                    </div>
                    <div id="fixedHome">
                        <a onclick="location.href = 'app.html'"><img src="images/Home1600.png" /></a>
                    </div>

                </div>
            </div>

            <div id="DivIconBackUserI" class="RoundDivIconBack">
                <a class="styleLink" onclick="goBack()"><img class="NiceIcon" src="images/backToLogin.png" /></a>
                <!--<h6 class="IconText">חזור</h6>-->
            </div>

        </div>


    </div>

    <!--<div data-role="page" data-dialog="true" data-close-btn="none" id="ImSureDialog1">
        <div data-role="header">
            <h2>תרמתי בבית</h2>
        </div>
        <div class="ui-content" role="main">
            <h4>האם אתה בטוח שאתה רוצה לעדכן את הנתונים במערכת?</h4>
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#UserDetailsPage" id="cancel-button" class="ui-btn ui-btn-b ui-shadow ui-corner-all">לא</a>
                </div>
                <div class="ui-block-b">
                    <a href="#UserDetailsPage" onclick="SubmitChanges()" id="exit-button" class="ui-btn ui-shadow ui-corner-all">כן</a>
                </div>
            </div>
        </div>
    </div>-->
    <script>

        //חזור
        function goBack() {
            location.href = `userDetails.html#UserDetailsPage`;
        }

        //הפעלת הודעות- האם אתה בטוח
        function AreYouSure() {

            swal({
                title: "שים לב",
                text: "האם את/ה בטוח/ה שאת/ה רוצה לעדכן את הנתונים במערכת?",
                type: "warning",
                showCancelButton: true,
                cancelButtonText: "#DD6B55",
                cancelButtonText: "לא, אוודא נתונים",
                confirmButtonText: "כן, בטוח/ה",
                closeOnConfirm: false,
                closeOnCancel: false
            },
            function (isConfirm) {
                if (isConfirm) {
                    SubmitChanges();
                } else {
                    swal("שליחת הנתונים בוטלה", "עכשיו ניתן לוודא שוב את הנתונים :)", "error");
                }
            });
        }

    </script>
</body>

</html>
