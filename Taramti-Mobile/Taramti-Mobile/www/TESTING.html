<!DOCTYPE html>
<html>

<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--בשביל פונגאפ יש להוריד את השורה שמתחת מהערה-->
    <meta http-equiv="Content-Security-Policy" content="default-src * data:; font-src data: *; script-src 'self' 'unsafe-inline' 'unsafe-eval' *; style-src 'self' 'unsafe-inline' *; img-src * data: 'unsafe-inline'">

    <script src="cordova.js"></script>

    <link href="css/fa-fa-icons.min.css" rel="stylesheet" />
    <link href="css/w3.css" rel="stylesheet" />
    <link href="css/jqmCss.css" rel="stylesheet" />
    <link href="css/StyleSheet.css" rel="stylesheet" />
    <!--מאסטר-->
    <script src="js/master.js"></script>

    <script src="js/jquery.js"></script>
    <script src="js/jqm.js"></script>

    <script type="text/javascript" src="http://maps.google.com/maps/api/js?libraries=geometry&sensor=false&language=en"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBm8eut2C8AirtD3f9Ba2wvfS8EGGWMhqM"></script>
    <script type="text/javascript" src="javascripts/jquery.googlemap.js"></script>

    <script>
        const generic = GENERAL.auctionWebServerAddress;
        const gen = GENERAL.genericWebServerAddress;
    </script>

    <script>
        let enter;



        function GetAuctionPrice() {
            var x = 2;
            // alert("NANA");
            $.ajax({
                dataType: "json",
                url: generic + "GetAuctionPrice",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ auctionCode: x }),
                success: function (data) {
                    console.log("Ran");
                    var isUser = JSON.parse(data.d);

                },
                error: function (err) { }
            });
        }

        function GetAuctionByCode() {
            var auc = { AuctionID: 1 }
            // alert("NANA");
            $.ajax({
                dataType: "json",
                url: generic + "GetAuctionByCode",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ auc }),
                success: function (data) {
                    console.log("got inside");
                    var auction = JSON.parse(data.d);
                    console.log(auction)

                },
                error: function (err) { }
            });
        }

        function GetAllProductsCategories() {
            var x = 2;
            // alert("NANA");
            $.ajax({
                dataType: "json",
                url: generic + "GetAllProductsCategories",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({}),
                success: function (data) {
                    var isUser = JSON.parse(data.d);
                    console.log("user 0" + isUser[0])
                    console.log("user 0________-" + isUser[0])
                    console.log(isUser);
                },
                error: function (err) { }
            });
        }

        function OfferBid() {

            var auc1 = 1;
            var bid1 = 1000;
            var buy1 = 302921481;

            $.ajax({
                dataType: "json",
                url: generic + "OfferBid",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ auc: auc1, bid: bid1, buyer: buy1 }),
                success: function (data) {

                    console.log("נכנסתי");
                    var isUser = JSON.parse(data.d);

                    console.log(isUser);
                },
                error: function (err) { }
            });
        }

        function getLocation(city, lat, lng) {

            var mygc = new google.maps.Geocoder();
            var locationOrigem;
            var locationDestino;
            var latOrigem = 0;
            var longOrigem = 0;
            var latDestino = 0;
            var longDestino = 0;

            mygc.geocode({ 'address': city }, function (results, status) {
                locationOrigem = results[0].geometry.location;
                latOrigem = results[0].geometry.location.lat();
                longOrigem = results[0].geometry.location.lng();
                mygc.geocode({}, function (results, status) {
                    locationDestino = new google.maps.LatLng(lat, lng);
                    // alert(latDestino + " " + longDestino);
                    console.log(locationOrigem);
                    console.log(locationDestino);
                    return (google.maps.geometry.spherical.computeDistanceBetween(locationOrigem, locationDestino));
                });
            });
        }

        function insertsearch() {
            $.ajax({
                dataType: "json",
                url: generic + "testsearch",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({}),
                success: function (data) {

                    console.log("נכנסתי");
                    var isUser = JSON.parse(data.d);

                    console.log(isUser);
                },
                error: function (err) { }
            });
        }

        function addQuestion() {
            let questioner = { UserId: 986548654 };
            let quest = {
                ProdCode: 39,
                Question: "בדיקה בדיקתית~~!!!!",
                Questioner: questioner
            };
            $.ajax({
                dataType: "json",
                url: generic + "AddQuestion",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ quest: quest }),
                success: function (data) {

                    console.log("נכנסתי");
                    console.log("result-----" + data.d)
                },
                error: function (err) { }
            });
        }

        function addToPush() {
            $.ajax({
                dataType: "json",
                url: gen + "SavePushInfo",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ userId: "302921481", deviceString: "notification_id", platform: "user_platform" }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
        }

        function SendPush() {
            $.ajax({
                dataType: "json",
                url: gen + "SendPush",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ user: "300294485", head: "סתכל למעלה", msg: "מפיל עלייך תיק" }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
        }

        function LogOut() {
            localStorage.removeItem("UserID");
            location.href = "Login-Taramti.html";
        }

        function GetLeadingAuctions() {
            $.ajax({
                dataType: "json",
                url: generic + "Get_Current_LeadingAuctions",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ user_Id: "300294485" }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
        }

        function addToWatch() {
            let user = { UserId: 300294485 };
            let auc = {
                AuctionID: 38,
                Buyer: user
            };

            enter = Date.now();

            console.log(`date- ${enter}`);
            console.log(`auc===== ${auc}`);
            $.ajax({
                dataType: "json",
                url: generic + "AddToWatch_Log",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ auc: auc, enter: enter }),
                success: function (data) {

                    console.log("נכנסתי");
                    console.log("result-----" + data.d)
                },
                error: function (err) { }
            });

        }

        function updateWatch() {
            let user = { UserId: 300294485 };
            let auc = {
                AuctionID: 38,
                Buyer: user
            };


            leave = Date.now();

            console.log(`date- ${enter}`);
            console.log(`auc===== ${auc}`);
            $.ajax({
                dataType: "json",
                url: generic + "UpdateWatch_Log",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ auc: auc, enter: enter, leave: leave }),
                success: function (data) {

                    console.log("נכנסתי");
                    console.log("result-----" + data.d)
                },
                error: function (err) { }
            });
        }

        var catCode = [0, 0, 0, 0, 0];
        var assoc = [0, 0, 0, 0, 0];
        function GetAuctionsByParam() {
            $.ajax({
                dataType: "json",
                url: generic + "GetAuctionByParam",
                contentType: "application/json; charset=utf-8",
                type: "POST",            
                data: JSON.stringify({ lowPrice: "100", highPrice: "10000", catCode: catCode, assocTagCode: assoc, lat: "100", lng: "200", radius: "20", user_Id: "300294485" }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
        }

        function GetAllMySells() {
            $.ajax({
                dataType: "json",
                url: generic + "GetAllMySells",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ user_Id: "123468865" }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
        }

        function outbid() {
            $.ajax({
                dataType: "json",
                url: generic + "GetOutBiddedAuctions",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ user_Id: "302921481" }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
        }

        function GetAllAuctionsCategories() {
            $.ajax({
                dataType: "json",
                url: generic + "GetAllAuctionsCategories",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({  }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
        }

        function SmartElement() {
            $.ajax({
                dataType: "json",
                url: generic + "SmartElement",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ user_id: "301926647" }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
        }
    </script>

</head>

<body>
    <div data-role="page" id="RegisterAssocPage">
        <!--<input type="button" onclick="test()" value="GetAuctionByParam" />-->
        <input type="button" onclick="GetAuctionPrice()" value="GetAuctionPrice" />
        <input type="button" onclick="GetAllProductsCategories()" value="GetAllProductsCategories" />
        <input type="button" onclick="OfferBid()" value="OfferBid" />
        <input type="button" onclick="GetAuctionByCode()" value="GetAuctionByCode" />
        <input type="button" onclick="getLocation('נתניה', 32.4340458, 34.9196518)" value="GetLocation" />
        <input type="button" onclick="insertsearch()" value="insertsearch" />
        <input type="button" onclick="addQuestion()" value="add Question" />
        <input type="button" onclick="addToPush()" value="add Bush" />
        <input type="button" onclick="SendPush()" value="Send Bush" />
        <input type="button" onclick="GetAuctionsByParam()" value="GetAuctionsByParam" />
        <input type="button" onclick="GetAuctionsByParam()" value="GetAuctionsByParam" />

        <input type="button" onclick="GetLeadingAuctions()" value="GetLeadingAuctions" />
        
        <input type="button" onclick="GetAllMySells()" value="GetAllMySells" />
        <input type="button" onclick="GetAllAuctionsCategories()" value="GetAllAuctionsCategories" />
        <input type="button" onclick="outbid()" value="outbid" />

        <input type="button" onclick="SmartElement()" value="SmartElement" />

        <input type="button" onclick="addToWatch()" value="LOGGGGG" />
        <input type="button" onclick="updateWatch()" value="update log" />
        
        <!--<input type="button" onclick="LogOut()" value="LogOut" />-->
        <a href="#ImSureDialog" id="RegisterAssocbtn" class="ui-shadow ui-btn ui-corner-all ui-btn-block" data-transition="flip">התנתק</a>

        <form action="https://www.paypal.com/cgi-bin/webscr" method="post">

            <input type="hidden" name="cmd" value="_xclick" />
            <input type="hidden" name="business" value="heregteam@gmail.com" />

            <input type="hidden" name="item_name" value="My painting" />
            <input type="hidden" name="amount" value="10.00" />
            <input type="submit" value="Buy!" />
        </form>
    </div>

    <div data-role="page" data-dialog="true" data-close-btn="none" id="ImSureDialog">
        <div data-role="header">
            <h2>תרמתי בבית</h2>
        </div>
        <div class="ui-content" role="main">
            <h4>אוו, אתה עוזב כל כך מוקדם??</h4>
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#RegisterAssocPage" id="cancel-button" class="ui-btn ui-btn-b ui-shadow ui-corner-all">לא</a>
                </div>
                <div class="ui-block-b">
                    <a href="#RegisterAssocPage" onclick="LogOut()" id="exit-button" class="ui-btn ui-shadow ui-corner-all">כן</a>
                </div>
            </div>
        </div>
    </div>

</body>

</html>