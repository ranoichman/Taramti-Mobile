<!DOCTYPE html>
<html>

<head>
    <title>רישום עמותה</title>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="default-src * data:; font-src data: *; script-src 'self' 'unsafe-inline' 'unsafe-eval' *; style-src 'self' 'unsafe-inline' *; img-src * data: 'unsafe-inline'">
    <!--<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Fidele Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template,
    Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design" />-->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="./cordova.js"></script>

    <link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
    <link href="css/fa-fa-icons.min.css" rel="stylesheet" />
    <link href="css/w3.css" rel="stylesheet" />
    <link href="css/jqmCss.css" rel="stylesheet" />
    <link href="css/StyleSheet.css" rel="stylesheet" />
    <link href="dist/sweetalert/sweetalert.css" rel="stylesheet" charset="utf-8" />

    <script src="dist/sweetalert/sweetalert-dev.js" charset="utf-8"> </script>
    <script src="js/jquery.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jqm.js"></script>

    <script src="js/master.js"></script>
    <!--font-Awesome-->
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!--//font-Awesome-->
</head>

<body>

    <div class="loader">
        <img id="LoadingImg" src="img/just_logo.png" />
    </div>

    <!--דף זה מכיל הוספת עמותה-דף 1 -->

    <div class="pageBC" data-role="page" id="RegisterAssocPage">
        <!--<img id="BkgroundImg" src="images/LoginBackground.jpg" />-->
        <div id="MenuBarDiv" style="z-index:150" class="navigation-1 navigation-5">

            <img id="LogoBidIt" src="images/LogoBidIt.png" />
            <div class="nav-left">
                <img onclick="location.href = 'app.html'" style="z-index:150" id="TaramtiLogo" src="images/LogoCircle.png" />
            </div>
            <div class="nav-right">
                <span class="nav-list-it5">
                    <i class="fa fa-bars"></i>
                </span>

                <ul class="nav-top-list nav-top-list1">
                    <li><a onclick="location.href = 'app.html'">דף הבית</a><label>|</label></li>
                    <li><a onclick="location.href = 'AddingAuction-Taramti.html'">הוספת מכרז</a><label>|</label></li>
                    <li><a onclick="location.href = 'appSettings.html#SearchAssoc'">פרטי עמותות</a><label>|</label></li>
                    <li><a onclick="location.href = 'userDetails.html'">פרופיל משתמש</a><label>|</label></li>
                    <li><a onclick="location.href = 'appSettings.html#Settings'">הגדרות אפליקציה</a><label>|</label></li>
                    <li><a onclick="location.href='RegisterAssoc-Taramti.html'"><img class="MenuIconLeft" src="images/LeftArrow.png" />הוספת עמותה</a><label>|</label></li>
                    <li><a onclick="LogOut()"> התנתק <i class="fa fa-sign-out"></i></a></li>

                    <!--<li><a class="active" href="#"><i class="fa fa-home"></i>Home</a><label>|</label></li>-->
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>

        <div class="Form" id="RegisterAssocForm">
            <div class="input-field">
                <div class="input-top">
                    <h2 class="header">רישום עמותה חדשה</h2>
                    <div class="input-top-top">

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-sort-numeric-asc"></i>
                            <input type="number" id="AssocNum" value="" placeholder="מספר עמותה">
                            <div class="clearfix"> </div>
                        </div>
                        <!--כאן תהיה ולידציה של מספר חברה - בעצם עם הווב סרוויס-->

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-user"></i>
                            <input type="text" id="AssocName" value="" placeholder="שם עמותה">
                            <div class="clearfix"> </div>
                        </div>

                        <h4>תיאור העמותה</h4>
                        <textarea style="resize:none" class="form-control" id="AssocDesc" rows="15"></textarea>
                        <div class="clearfix"> </div>

                    </div>

                    <div class="page-top-mid">
                        <div class="page-top-mid1" id="AddAssocProcessTop">
                            <ul class="page-mid1" id="AddAssocProcess">

                                <li><a class="next-top1" onclick="location.href = 'app.html'"><img class="pre12" src="images/BackArrowIcon.png" /></a></li>
                                <li class="Num"><span>1</span></li>
                                <li class="Num"><a onclick="ToRegisterAssocPage2()">2</a></li>
                                <li><a class="pre1" onclick="ToRegisterAssocPage2()"><i><img class="pre12" src="images/forrwardArrowIcon.png" /></i></a></li>
                            </ul>
                        </div>
                        <div class="clearfix"> </div>
                    </div>
                </div>
                <div class="FixedButton">
                    <div class="RoundDivfixed">
                        <div id="fixedCircle">
                            <a onclick="location.href = 'app.html'"><img src="images/circle-for-home.png" /></a>
                        </div>
                        <div id="fixedHome">
                            <a onclick="location.href = 'app.html'"><img src="images/Home1600.png" /></a>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--דף זה מכיל הוספת עמותה-דף 2 -->
    <div class="pageBC" data-role="page" id="RegisterAssocPage2">
        <!--<img id="BkgroundImg" src="images/LoginBackground.jpg" />-->
        <div id="MenuBarDiv" style="z-index:150" class="navigation-1 navigation-5">

            <img id="LogoBidIt" src="images/LogoBidIt.png" />
            <div class="nav-left">
                <img onclick="location.href = 'app.html'" style="z-index:150" id="TaramtiLogo" src="images/LogoCircle.png" />
            </div>
            <div class="nav-right">
                <span class="nav-list-it5">
                    <i class="fa fa-bars"></i>
                </span>

                <ul class="nav-top-list nav-top-list1">
                    <li><a onclick="location.href = 'app.html'">דף הבית</a><label>|</label></li>
                    <li><a onclick="location.href = 'AddingAuction-Taramti.html'">הוספת מכרז</a><label>|</label></li>
                    <li><a onclick="location.href = 'appSettings.html#SearchAssoc'">פרטי עמותות</a><label>|</label></li>
                    <li><a onclick="location.href = 'userDetails.html'">פרופיל משתמש</a><label>|</label></li>
                    <li><a onclick="location.href = 'appSettings.html#Settings'">הגדרות אפליקציה</a><label>|</label></li>
                    <li><a onclick="location.href='RegisterAssoc-Taramti.html'"><img class="MenuIconLeft" src="images/LeftArrow.png" />הוספת עמותה</a><label>|</label></li>
                    <li><a onclick="LogOut()"> התנתק <i class="fa fa-sign-out"></i></a></li>

                    <!--<li><a class="active" href="#"><i class="fa fa-home"></i>Home</a><label>|</label></li>-->
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>

        <div class="Form" id="RegisterAssocForm">
            <div class="input-field">
                <div class="input-top">
                    <h2 class="header">רישום עמותה חדשה</h2>
                    <div class="input-top-top">

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-credit-card"></i>
                            <input type="email" id="AssocAccount" value="" placeholder=" חשבון עמותה- PayPal">
                            <div class="clearfix"> </div>
                        </div>
                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-globe"></i>
                            <input type="email" id="AssocWebsite" value="" placeholder="אתר העמותה">
                            <div class="clearfix"> </div>
                        </div>
                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-calendar"></i>
                            <input type="number" id="AssocYear" value="" placeholder="שנת היווסדות">
                            <div class="clearfix"> </div>
                        </div>

                        <p class="loginText">בלחיצה על 'רשום עמותה' אתה מסכים לתנאים הבאים <a href="#">תנאים מחייבים</a>.</p>

                        <!--<a href="#ImSureDialog" id="RegisterAssocbtn" class="ui-shadow ui-btn ui-corner-all ui-btn-block" data-transition="flip">רשום עמותה</a>-->
                        <div class="button-1">
                            <button type="button" id="RegisterAssocbtn" onclick="AreYouSure()" class="btn-l btn-10">רשום עמותה</button>
                        </div>


                        <div class="clearfix"> </div>
                    </div>
                    <div class="page-top-mid">
                        <div class="page-top-mid1" id="AddAssocProcessTop">
                            <ul class="page-mid1" id="AddAssocProcess">
                                <li><a href="#RegisterAssocPage" class="next-top1"><img class="pre12" src="images/BackArrowIcon.png" /></a></li>
                                <li class="Num"><a href="#RegisterAssocPage">1</a></li>
                                <li class="Num"><span>2</span></li>
                                <li><a class="pre1" onclick="AreYouSure()"><img class=" pre12" src="images/forrwardArrowIcon.png" /></a></li>
                            </ul>
                        </div>
                        <div class="clearfix"> </div>
                    </div>
                </div>
                <div class="FixedButton">
                    <div class="RoundDivfixed">
                        <div id="fixedCircle">
                            <a onclick="location.href = 'app.html'"><img src="images/circle-for-home.png" /></a>
                        </div>
                        <div id="fixedHome">
                            <a onclick="location.href = 'app.html'"><img src="images/Home1600.png" /></a>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>
        const assoc = GENERAL.assocWebServerAddress;
    </script>

    <script>
        //טעינה
        $(window).load(function () {
            setTimeout(() =>
                $(".loader").fadeOut("slow"), 500);
        })

        $(document).ready(function () {
            var _originalSize = $(window).width() + $(window).height()
            $(window).resize(function () {
                if ($(window).width() + $(window).height() != _originalSize) {
                    $(".FixedButton").css("display", "none");
                }
                else {
                    $(".FixedButton").css("display", "block");
                }
            });


            $("span.nav-list-it5").on("tap", function () {
                $("ul.nav-top-list1").slideToggle("slow", function () {
                    // Animation complete.
                });
            });
        });

        //התנתקות
        function LogOut() {
            localStorage.removeItem("UserID");
            location.href = 'Login-Taramti.html'
        }

        //מעבר לעמוד ה-2 בהרשמה, בדיקת שדות
        function ToRegisterAssocPage2() {
            var Code = $("#AssocNum").val();
            var Name = $("#AssocName").val();
            var Desc = $("#AssocDesc").val();

            if (Name == "" || Desc == "") {
                swal({
                    title: "שים לב",
                    text: "יש למלא את כל השדות",
                    type: "warning",
                    confirmButtonText: "אישור"
                })

            }
            else {
                if (Code == "") {
                    swal({
                        title: "שים לב",
                        text: "יש להזין קוד עמותה תקין. על הקוד להכיל ספרות בלבד",
                        type: "warning",
                        confirmButtonText: "אישור"
                    })
                }
                else {
                    location.href = "RegisterAssoc-Taramti.html#RegisterAssocPage2";
                }
            }
        }

        //בדיקת שדות לעמוד ה-2 והפעלת הודעות- האם אתה בטוח?
        function AreYouSure() {

            var Account = $("#AssocAccount").val();
            var Web = $("#AssocWebsite").val();
            var Year = $("#AssocYear").val();

            if (Account == "" || Web == "") {
                swal({
                    title: "שים לב",
                    text: "יש למלא את כל השדות",
                    type: "warning",
                    confirmButtonText: "אישור"
                })
            }
            else {
                if (Year == "") {
                    swal({
                        title: "שים לב",
                        text: "יש להזין את שנת ההיווסדות בספרות בלבד",
                        type: "warning",
                        confirmButtonText: "אישור"
                    })
                }
                else {

                    swal({
                        title: "שים לב",
                        text: "פרטי העמותה שהזנת נשלחים אל רשם העמותות לבדיקה, האם את/ה בטוח/ה שהפרטים שהזנת נכונים?",
                        type: "warning",
                        showCancelButton: true,
                        cancelButtonText: "#DD6B55",
                        cancelButtonText: "לא, אוודא נתונים",
                        confirmButtonText: "כן, בטוח/ה",  
                        closeOnConfirm: false,
                        closeOnCancel: false
                    },
                    function (isConfirm) {
                        if (isConfirm) {
                            RegisterAssoc();
                        } else {
                            swal("שליחת הנתונים בוטלה", "עכשיו ניתן לוודא שוב את הנתונים :)", "error");
                        }
                    });
                }
            }

        }

        //הוספת עמותה
        function RegisterAssoc() {

            var Code = $("#AssocNum").val() != "" ? $("#AssocNum").val() : null;
            var Name = $("#AssocName").val();
            var Desc = $("#AssocDesc").val();
            var Account = $("#AssocAccount").val();
            var Web = $("#AssocWebsite").val();
            var Year = $("#AssocYear").val();
            $(".loader").fadeIn("fast");

            $.ajax({
                dataType: "json",
                url: "http://proj.ruppin.ac.il/bgroup51/test1/bekeilu/ValidateAmuta/WebService.asmx" + "/ValidateAmuta",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ code: Code }),
                success: function (data) {
                    var amuta = data.d;

                    if (amuta == true) {
                        $.ajax({
                            dataType: "json",
                            url: assoc + "AddNewAssoc",
                            contentType: "application/json; charset=utf-8",
                            type: "POST",
                            data: JSON.stringify({ code: Code, name: Name, desc: Desc, account: Account, web: Web, year: Year }),
                            success: function (data) {

                                var amu = JSON.parse(data.d);

                                if (amu == "True") {
                                    $(".loader").fadeOut("slow");
                                    swal({
                                        title: "זהו..",
                                        text: "העמותה נרשמה בהצלחה",
                                        type: "success",
                                        confirmButtonText: "אישור",
                                    },
                                    function () {
                                        location.href = "app.html";
                                    })
                                }
                                else {
                                    $(".loader").fadeOut("slow");
                                    swal({
                                        title: "שים לב",
                                        text: "ככל הנראה אירעה שגיאה בשרת בעת רישום העמותה, יש לנסות מאוחר יותר",
                                        type: "error",
                                        confirmButtonText: "אישור"
                                    })
                                }
                            },
                            error: function (err) {
                                $(".loader").fadeOut("slow");
                            }
                        });// Ajax AddNewAssoc
                    }
                    else {
                        $.ajax({
                            dataType: "json",
                            url: assoc + "AddNewTempAssoc",
                            contentType: "application/json; charset=utf-8",
                            type: "POST",
                            data: JSON.stringify({ code: Code, name: Name, desc: Desc, account: Account, web: Web, year: Year }),
                            success: function (data) {
                                var amu = JSON.parse(data.d);

                                if (amu == "True") {
                                    $(".loader").fadeOut("slow");
                                    swal({
                                        title: "שים לב",
                                        text: "העמותה הועברה לאישור מנהלי המערכת. ניצור עמכם קשר תוך 2 ימי עסקים להשלמת תהליך הרישום",
                                        type: "warning",
                                        confirmButtonText: "אישור"
                                    },
                                        function () {
                                            location.href = "app.html";
                                        });
                                }
                                else {
                                    $(".loader").fadeOut("slow");
                                    swal({
                                        title: "שים לב",
                                        text: "ככל הנראה אירעה שגיאה בשרת בעת רישום העמותה, יש לנסות מאוחר יותר",
                                        type: "error",
                                        confirmButtonText: "אישור"
                                    })
                                }
                            },
                            error: function (err) {
                                $(".loader").fadeOut("slow");
                            }
                        });// Ajax AddNewTempAssoc
                    }
                },
                error: function (err) {
                    $(".loader").fadeOut("slow");
                }
            });// Ajax ValidateAssoc

        }
    </script>

</body>

</html>
