<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src *; script-src 'self' 'unsafe-inline' 'unsafe-eval' *; style-src 'self' 'unsafe-inline' *; img-src * data: 'unsafe-inline'">
    <link href="css/fa-fa-icons.min.css" rel="stylesheet" />
    <link href="css/w3.css" rel="stylesheet" />
    <link href="css/jqmCss.css" rel="stylesheet" />
    <link href="css/StyleSheet.css" rel="stylesheet" />


    <script src="js/jquery.js"></script>
    <script src="js/jqm.js"></script>
    <script src="js/appFuncs.js"></script>

    <script src="cordova.js"></script>

   <script>
        var picA = [];
        $(document).ready(function () {

            var lsIndex = parseInt((localStorage.getItem("lsIndex")));
            for (var j = 0; j <= lsIndex; j++) {
                var tempPic = JSON.parse(localStorage.getItem(j.toString()));
                picA.push(tempPic);
            }
        });

        function map_loaded() {

            navigator.geolocation.getCurrentPosition(function (pos) {
                var center_on = { lat: pos.coords.latitude, lng: pos.coords.longitude };
                map = new google.maps.Map(document.getElementById('fullMap'), {
                    zoom: 14,
                    center: center_on,
                    mapTypeId: google.maps.MapTypeId.HYBRID
                });

                var marker = new google.maps.Marker({
                    position: center_on,
                    map: map,
                    icon: "fonts/map-icons-master/src/icons/abseiling.svg",
                    animation: google.maps.Animation.BOUNCE,
                });

                for (j in picA)
                {
                    addMarker(picA[j]);
                }

            }, function (err) {

                alert(err.message);
            })
        }

        function addMarker(obj) {
            var marker = new google.maps.Marker({
                position: obj.picLocation,
                map: map,
            });
            var $img = $("<img>").attr({ "src": obj.picPath });
            var $name = $("<h2>").attr({ "class": "name" }).text(obj.picTitle);
            var $desc = $("<p>").attr({ "class": "desc" }).text(obj.picDesc);
            var $cont = $("<div>").append($img).append($name).append($desc);
            var info_Window = new google.maps.InfoWindow({
                content: $cont[0].innerHTML
            });
            google.maps.event.addListener(marker, 'click', function () {
                info_Window.open(map, marker);
            })

        }


    </script>
    <script>
        // לעריכה
        function ToEdit() {
            location.href = "Tar_3.html#edit";
        };
        // לגלריה
        function ToGallery() {
            location.href = "Tar_3.html#gallery";
        };
        // למועדפים
        function ToFav() {
            location.href = "Tar_3.html#favorites";
        };
    </script>


    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7V7yMw2QgAW5aDmFFFYc_Ga8aTAqv0TU&callback=map_loaded">
    </script>
</head>
<body>
    <div data-role="navbar" id="mainpage">
        <ul>
            <li> <a data-icon="grid" onclick="ToGallery()"> גלריה</a></li>
            <li> <a data-icon="star" onclick="ToFav()">מועדפים </a></li>
            <li> <a data-icon="edit" onclick="ToEdit()">עדכון פרטים</a></li>
            <li> <a data-icon="info" href="Map_Marker.html" class="w3-blue w3-text-white">מפה</a></li>
        </ul>
    </div>
    <div id="fullMap" style="width:100%; height:800px; margin: 0 auto;"></div>
</body>
</html>
