<!DOCTYPE html>
<html>
<head>
    <title>Bid it התחברות</title>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="default-src * data:; font-src data: *; script-src 'self' 'unsafe-inline' 'unsafe-eval' *; style-src 'self' 'unsafe-inline' *; img-src * data: 'unsafe-inline'">
    <!--<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Fidele Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template,
    Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design" />-->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
    <link href="css/fa-fa-icons.min.css" rel="stylesheet" />
    <link href="css/w3.css" rel="stylesheet" />
    <link href="css/jqmCss.css" rel="stylesheet" />
    <link href="css/StyleSheet.css" rel="stylesheet" />

    <script src="js/jquery.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jqm.js"></script>

    <script src="js/master.js"></script>
    <!--font-Awesome-->
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!--//font-Awesome-->
</head>
<body>

    <!--דף לוגין-->
    <div data-role="page" id="LoginPage">
        <img id="BkgroundImg" src="images/LoginBackground.jpg" />
        <div id="DivLogo">
            <img id="MainLogoImg" src="images/MainLogo.png" />
        </div>
        <div class="LoginForm" id="LoginForm" style="">

            <div class="input-field">
                <div class="input-top">
                    <h2 class="header">כיף שבאת!</h2>
                    <div class="input-top-top">

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-envelope"></i>
                            <input type="email" id="UserMail" value="" placeholder="מייל משתמש">
                            <div class="clearfix"> </div>
                        </div>
                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-key"></i>
                            <input type="password" id="UserPass" value="" placeholder="סיסמת משתמש">
                            <div class="clearfix"> </div>
                        </div>
                    </div>

                    <div class="clearfix"> </div>
                </div>

                <div class="button-1">
                    <button type="button" id="Loginbtn" class=" btn-l btn-10">התחבר</button>
                </div>

            </div>
            <!--<h5 class="styleLinkH"><a class="styleLink" href="#ForgotPassPage"> שכחת סיסמה?! לחץ כאן</a></h5>-->
            <!--<h6 class="styleLinkH"><a class="styleLink" href="#FirstRegisterPage">לא רשום? לחץ כאן! </a></h6>-->
        </div>
        <div class="RoundDivIcon">
            <a class="styleLink" href="#FirstRegisterPage1"><img class="NiceIcon" src="images/add_user_male1600.png" /></a>
        </div>

        <div class="RoundDivIcon">
            <a class="styleLink" href="#ForgotPassPage"><img class="NiceIcon" src="images/forgot_password1600.png" /></a>
        </div>


    </div>

    <!--דף שכחתי סיסמה-->
    <div data-role="page" id="ForgotPassPage">
        <img id="BkgroundImg" src="images/LoginBackground.jpg" />
        <div id="DivLogo">
            <img id="MainLogoImg" src="images/MainLogo.png" />
        </div>
        <div class="LoginForm" id="ForgotPassForm">
            <div class="input-field">
                <div class="input-top">
                    <h2 class="header">שכחת סיסמה?!</h2>
                    <div class="input-top-top">
                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-envelope"></i>
                            <input type="email" id="UserMailForgot" value="" placeholder="הזן כתובת אימייל">
                            <div class="clearfix"> </div>
                        </div>

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-user"></i>
                            <input type="number" id="UserId" value="" placeholder="הזן תעודת זהות">
                            <div class="clearfix"> </div>
                        </div>
                    </div>

                    <div class="clearfix"> </div>
                </div>
                <div class="button-1">
                    <button type="button" id="ForgotBtn" onclick="SendMailPass()" class="btn-l btn-10">שלח לי מייל</button>
                </div>
            </div>
            <!--<h5 class="styleLinkH"><a class="styleLink" href="#LoginPage"> נזכרתי בסיסמה! אני רוצה להתחבר</a></h5>-->
        </div>
        <div class="surroundDiv">
            <div class="RoundDivIcon">
                <a class="styleLink" href="#FirstRegisterPage1"><img class="NiceIcon" src="images/add_user_male1600.png" /></a>
            </div>
            <div class="RoundDivIcon">
                <a class="styleLink" href="#LoginPage"><img class="NiceIcon" src="images/backToLogin.png" /></a>
            </div>
        </div>
    </div>
    <!--דף שחזור סיסמה-->
    <div data-role="page" id="RestorePassPage">
        <img id="BkgroundImg" src="images/LoginBackground.jpg" />
        <div id="DivLogo">
            <img id="MainLogoImg" src="images/MainLogo.png" />
        </div>
        <div class="LoginForm" id="RestorePassForm">
            <div class="input-field">
                <div class="input-top">
                    <h2 class="header">שחזור סיסמה</h2>
                    <div class="input-top-top">

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-envelope"></i>
                            <input type="number" id="UserIdRestore" value="" placeholder="הזן ת.ז">
                            <div class="clearfix"> </div>
                        </div>

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-key"></i>
                            <input type="password" id="UserPassNew" value="" placeholder="הזן סיסמה">
                            <div class="clearfix"> </div>
                        </div>


                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-key"></i>
                            <input type="password" id="UserPassNew2" value="" placeholder="הזן סיסמה לאישור">
                            <div class="clearfix"> </div>
                        </div>
                    </div>
                    <div class="clearfix"> </div>
                </div>
                <div class="button-1">
                    <button type="button" id="RestorePassBtn" onclick="RestorePass()" class="btn-l btn-10">שנה סיסמה</button>
                </div>
            </div>
        </div>
    </div>

    <!--דף רישום ראשוני1-->
    <div data-role="page" id="FirstRegisterPage1">
        <img id="BkgroundImg" src="images/LoginBackground.jpg" />
        <div id="DivLogo">
            <img id="MainLogoImg" src="images/MainLogo.png" />
        </div>
        <div class="LoginForm" id="FirstRegisterForm">
            <div id="FirstRegister_input-field" class="input-field">
                <div class="input-top">
                    <h2 class="header">רישום משתמש</h2>
                    <!--<h6 class="loginText">רישום זה הוא רישום ראשוני,<br /> כדי לבצע מכירה או רכישה יהיה עליך לבצע רישום מלא</h6>-->
                    <div class="input-top-top">
                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-envelope"></i>
                            <input type="email" id="Usermail" value="" placeholder="כתובת אימייל">
                            <div class="clearfix"> </div>
                        </div>

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-key"></i>
                            <input type="password" id="UserPass" value="" placeholder="הזן סיסמה">
                            <div class="clearfix"> </div>
                        </div>

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-key"></i>
                            <input type="password" id="UserPass2" value="" placeholder="הזן סיסמה לאישור">
                            <div class="clearfix"> </div>
                        </div>
                    </div>
                    <div class="clearfix"> </div>
                </div>
                <div class="page-top-mid">
                    <div class="page-top-mid1">
                        <ul class="page-mid1" id="AddUserProcess">
                            
                            <li><a class="next-top1" href="#LoginPage"><img class="pre12" src="images/BackArrowIcon.png" /></a></li>
                            <li class="Num"><span>1</span></li>
                            <li class="Num"><a href="#FirstRegisterPage2">2</a></li>
                            <li class="Num"><a href="#">3</a></li>
                            <li><a class="pre1" href="#FirstRegisterPage2" ><i><img class="pre12" src="images/forrwardArrowIcon.png" /></i></a></li>
                        </ul>
                    </div>
                    <div class="clearfix"> </div>
                </div>
            </div>
            <!--<h5 class="styleLinkH"><a class="styleLink" href="#LoginPage"> חזור לדף התחברות</a></h5>-->
        </div>
        <!--<div class="RoundDivIcon">
            <a class="styleLink" href="#FirstRegisterPage2"><img class="NiceIcon" src="images/forrwardArrowIcon.png" /></a>
            <h6 class="IconText">המשך</h6>
        </div>
        <div class="RoundDivIcon">
            <a class="styleLink" href="#LoginPage"><img class="NiceIcon" src="images/backToLogin.png" /></a>
            <h6 class="IconText">חזור</h6>
        </div>-->
    </div>
    <!--דף רישום ראשוני 2 המשך-->
    <div data-role="page" id="FirstRegisterPage2">
        <img id="BkgroundImg" src="images/LoginBackground.jpg" />
        <div id="DivLogo">
            <img id="MainLogoImg" src="images/MainLogo.png" />
        </div>
        <div class="LoginForm" id="FirstRegisterForm">
            <div class="input-field">
                <div class="input-top">
                    <h2 class="header">רישום משתמש</h2>
                    <!--<h6 class="loginText">רישום זה הוא רישום ראשוני,<br /> כדי לבצע מכירה או רכישה יהיה עליך לבצע רישום מלא</h6>-->
                    <div class="input-top-top">
                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-user-plus"></i>
                            <input type="text" id="UserFirstName" value="" placeholder="שם פרטי">
                            <div class="clearfix"> </div>
                        </div>

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-user-plus"></i>
                            <input type="text" id="UserLastName" value="" placeholder="שם משפחה">
                            <div class="clearfix"> </div>
                        </div>

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-user-plus"></i>
                            <input type="number" id="Userid" value="" placeholder="תעודת זהות">
                            <div class="clearfix"> </div>
                        </div>
                        <!--<p class="loginText">בלחיצה על הרשם אתה מסכים לתנאים הבאים <a href="#">תנאים מחייבים</a>.</p>-->
                    </div>
                    <div class="clearfix"> </div>
                </div>
                <!--<div class="button-1">
                    <button type="button" id="FirstRegisterBtn" onclick="FirstRegisterUser()" class="btn-l btn-10">הרשם לבינתיים</button>
                </div>-->
                <!--<div class="button-1">
                    <button type="button" id="ConRegisterBtn" onclick="ConRegister()" class="btn-l btn-10">המשך לרישום מלא</button>
                </div>-->
                <div class="page-top-mid">
                    <div class="page-top-mid1">
                        <ul class="page-mid1" id="AddUserProcess">
                            <li><a class="next-top1" href="#FirstRegisterPage1"><img class="pre12" src="images/BackArrowIcon.png" /></a></li>
                            <li class="Num"><a href="#FirstRegisterPage1">1</a></li>
                            <li class="Num"><span>2</span></li>
                            <li class="Num"><a onclick="ConRegister()" href="#CompleteRegisterPage">3</a></li>
                            <li><a class="pre1" onclick="ConRegister()" href="#CompleteRegisterPage"><i><img class="pre12" src="images/forrwardArrowIcon.png" /></i></a></li>
                        </ul>
                    </div>
                    <div class="clearfix"> </div>
                </div>
            </div>
            <!--<h5 class="styleLinkH"><a class="styleLink" href="#LoginPage"> חזור לדף התחברות</a></h5>-->
        </div>
        <!--<div class="RoundDivIcon">
            <a class="styleLink" href="#FirstRegisterPage1"><img class="NiceIcon" src="images/backToLogin.png" /></a>
        </div>-->
    </div>

    <!--דף השלמה לרישום מלא-->
    <div data-role="page" id="CompleteRegisterPage">
        <img id="BkgroundImg" src="images/LoginBackground.jpg" />
        <div id="DivLogo">
            <img id="MainLogoImg" src="images/MainLogo.png" />
        </div>
        <div class="LoginForm" id="CompleteRegisterForm">
            <div class="input-field">
                <div class="input-top">
                    <h2 class="header">רישום משתמש</h2>
                    <!--<h2 class="header">רישום משתמש מלא</h2>-->
                    <div class="input-top-top">
                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-phone"></i>
                            <input type="number" id="UserPhon" value="" placeholder="מספר טלפון">
                            <div class="clearfix"> </div>
                        </div>

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-globe"></i>
                            <input type="number" id="UserCity" value="" placeholder="עיר מגורים">
                            <div class="clearfix"> </div>
                        </div>

                        <!--<h4>עיר מגורים: </h4>
                        <select id="UserCity" onclick="CityList()" data-icon="arrow-r">
                            <option value="-1"> בחר</option>
                        </select>-->

                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-building"></i>
                            <input type="text" id="UserStreet" value="" placeholder="רחוב">
                            <div class="clearfix"> </div>
                        </div>
                        <div class="input-top-mid input-top-mid7">
                            <i class="fa fa-home"></i>
                            <input type="text" id="UserHomeNum" value="" placeholder="מספר בית">
                            <div class="clearfix"> </div>
                        </div>
                        <!--<div class="input-top-mid input-top-mid7">
                            <i class="fa fa-street-view"></i>
                            <input type="text" id="UserHomeNum2" value="" placeholder="מספר דירה">
                            <div class="clearfix"> </div>
                        </div>-->
                        <p class="loginText">בלחיצה על הרשם אתה מסכים לתנאים הבאים <a href="#">תנאים מחייבים</a>.</p>
                    </div>
                    <div class="clearfix"> </div>
                </div>
                <!--<div class="button-1">
                    <button type="button" id="CompleteRegisterBtn" onclick="RegisterUser()" class="btn-l btn-10">הרשם</button>
                </div>-->
                <div class="page-top-mid">
                    <div class="page-top-mid1">
                        <ul class="page-mid1" id="AddUserProcess">

                            <li><a class="next-top1" href="#FirstRegisterPage2"><img class="pre12" src="images/BackArrowIcon.png" /></a></li>
                            <li class="Num"><a href="#FirstRegisterPage1">1</a></li>
                            <li class="Num"><a href="#FirstRegisterPage2">2</a></li>
                            <li class="Num"><span>3</span></li>
                            <li><a class="pre1" href="#LoginPage"><i><img class="pre12" src="images/forrwardArrowIcon.png" /></i></a></li>
                        </ul>
                    </div>
                    <div class="clearfix"> </div>
                </div>
                <!--<h5><a href="#FirstRegisterPage"> חזור</a></h5>-->
            </div>
        </div>
    </div>

    <!--דף רישום משתמש-->
    <div data-role="page" id="RegisterPage">
        <img id="BkgroundImg" src="images/LoginBackground.jpg" />
        <div id="DivLogo">
            <img id="MainLogoImg" src="images/MainLogo.png" />
        </div>
        <div class="LoginForm" id="RegisterForm">
            <div class="input-field">
                <div class="input-top">
                    <div class="input-top-top">
                        <h2>רישום משתמש</h2>
                        <h4>שם פרטי: </h4>
                        <input type="text" id="UserFirstName" />
                        <h4>שם משפחה: </h4>
                        <input type="text" id="UserLastName" />
                        <h4>תעודת זהות: </h4>
                        <input type="number" id="UserId" />
                        <h4>מספר טלפון: </h4>
                        <input type="tel" id="UserPhon" />
                        <h4>עיר מגורים: </h4>
                        <input type="text" id="UserCity" />
                        <h4>רחוב: </h4>
                        <input type="text" id="UserStreet" />
                        <h4>מספר: </h4>
                        <input type="number" id="UserHomeNum" />
                        <h4>כתובת אימייל: </h4>
                        <input type="email" id="UserMail" />
                        <h4>הזן סיסמה: </h4>
                        <input type="password" id="UserPass" />
                        <h4>הזן סיסמה לאישור: </h4>
                        <input type="password" id="UserPass2" />
                    </div>
                    <div class="clearfix"> </div>
                </div>
                <div class="button-1">
                    <button type="button" id="RegisterBtn" onclick="RegisterUser()" class="btn-l btn-10">הרשם</button>
                </div>
                <!--<h5 class="styleLinkH"><a class="styleLink" a href="#LoginPage"> חזור לדף התחברות</a></h5>-->
            </div>
        </div>
        <div class="RoundDivIcon">
            <a class="styleLink" href="#LoginPage"><img class="NiceIcon" src="images/backToLogin.png" /></a>
        </div>
    </div>



    <script>
        const Gen = GENERAL.USER;
        const generic = GENERAL.genericWebServerAddress;
        var SENDER_ID = "336880743356";
        var user_platform = "";
        var notification_id = "";
        var webServerAddress = "http://proj.ruppin.ac.il/bgroup51/test2/WebService.asmx/";

        if (localStorage.UserID != null) {
            location.href = "app.html";
        }

        $(document).ready(function () {
            $("#Loginbtn").on("tap", function () {
                var mail = $("#UserMail").val();
                var pass = $("#UserPass").val();
                //alert("ready - doc");

                $.ajax({
                    dataType: "json",
                    url: generic + "ValidateUser",
                    contentType: "application/json; charset=utf-8",
                    type: "POST",
                    data: JSON.stringify({ mail: mail, pass: pass }),
                    success: function (data) {

                        var isUser = JSON.parse(data.d);

                        if (isUser == true) {
                            // בדיקה האם המשתמש עם סיסמא זמנית. אם כן - נשלח אותו ליצירת סיסמא חדשה
                            if (pass == "000000") {
                                location.href = "Login-Taramti.html#RestorePassPage";
                            }
                            else {
                                $.ajax({
                                    dataType: "json",
                                    url: generic + "GetUserID",
                                    contentType: "application/json; charset=utf-8",
                                    type: "POST",
                                    data: JSON.stringify({ mail: mail, pass: pass, device: notification_id, platform: user_platform }),
                                    success: function (data) {

                                        var UserId = JSON.parse(data.d);
                                        localStorage.setItem("UserID", UserId);
                                        location.href = "app.html";
                                    },
                                    error: function (err) { }
                                });

                                //location.href = "app.html";
                            }
                        }
                        else {
                            alert("שם המשתמש או הסיסמא אינם תואמים את נתוני המערכת. אנא נסה שנית");
                            location.href = "Login-Taramti.html#LoginPage";
                        }
                    },
                    error: function (err) { }
                });
            }


            )
        });

        // קריאת נתונים לצורך הודעות פוש בהמשך
        document.addEventListener("deviceready", onCordovaReady, false);
        function onCordovaReady() {
            try {
                var push = PushNotification.init({
                    "android": {
                        "senderID": SENDER_ID
                    },
                    "ios": {
                        "alert": "true",
                        "badge": "true",
                        "sound": "true",
                        "senderID": SENDER_ID,
                        "gcmSandbox": true
                    },
                    "windows": {}
                });

                push.on('registration', function (data) {
                    notification_id = data.registrationId;
                    if (IsIphone()) {
                        user_platform = "ios";
                    }
                    else {
                        user_platform = "android";
                    }
                });
            } catch (e) {
                alert(e.message);
            }
            push.on('notification', function (data) {
                console.log("notification event");

                if (data.additionalData.foreground && data.additionalData.sender != localStorage.user_name) {

                    addMessageToChat(data.additionalData.sender, data.message);
                }
                else {

                }

                push.finish(function () {
                    console.log('finish successfully called');
                });
            });

            push.on('error', function (e) {
                alert("error----" + e.message)
                console.log("push error");
            });
        }

        function IsIphone() {
            var userAgent = navigator.userAgent;

            if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                return true;
            }
            else {

                return false;
            }
        }

        function sendMsg() {
            if ($("#msg").val() == "") {
                return;
            }

            $.ajax({

                type: "POST",
                url: webServerAddress + "NotificationCenter.asmx/SendMessage",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ user_name: localStorage.user_name, msg: $("#msg").val() }),
                dataType: "json",
                success: function (data) {


                },
                error: function () {

                }

            })

            addMessageToChat(localStorage.user_name, $("#msg").val());
            $("#msg").val('');
            window.scrollTo(0, document.body.scrollHeight);
        }

        function register() {
            alert("regID ===" + notification_id)
            alert("platforma ===" + user_platform)
            $.ajax({
                dataType: "json",
                url: webServerAddress + "SavePushInfo",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                //data: JSON.stringify({ userId: UserId, deviceString: res.registrationId, platform: res.platform }),
                //data: JSON.stringify({ userId: "302921481", deviceString': notification_id, platform: user_platform }),
                data: JSON.stringify({ userId: "302921481", deviceString: notification_id, platform: user_platform }),
                success: function (data) {

                    var isUser = JSON.parse(data.d);
                },
                error: function (err) { }
            });
            //$.ajax({
            //    type: "POST",
            //    url: webServerAddress + "SavePushInfo",
            //    contentType: "application/json; charset=utf-8",
            //    data: JSON.stringify({ userId: "302921481", deviceString: "shmegeg", platform: "shmok" }),
            //    dataType: "json",
            //    success: function (data) {
            //        alert("יששששששששששששששש");
            //        localStorage.user_name = $("#user_name").val();
            //        location.href = "#sendPush"
            //    },
            //    error: function () {
            //        //alert("error");
            //    }
            //});

            //var SENDER_ID = "336880743356";

            //document.addEventListener("deviceready", onCordovaReady, false);



            //function onCordovaReady() {

            //    alert("ready");
            //    var push = PushNotification.init({
            //        "android": {
            //            "senderID": SENDER_ID
            //        },
            //        "ios": {
            //            "alert": "true",
            //            "badge": "true",
            //            "sound": "true",
            //            "senderID": SENDER_ID,
            //            "gcmSandbox": true
            //        },
            //        "windows": {}
            //    });
            //    alert("אחרי אינישיאלייז");

            //    push.on('registration', function (data) {
            //        alert("Reg");
            //        notification_id = data.registrationId;

            //        if (IsIphone()) {
            //            user_platform = "ios";
            //        }
            //        else {
            //            user_platform = "android";
            //        }
            //    });

            //    push.on('notification', function (data) {
            //        console.log("notification event");

            //        if (data.additionalData.foreground && data.additionalData.sender != localStorage.user_name) {

            //            addMessageToChat(data.additionalData.sender, data.message);
            //        }
            //        else {

            //        }


            //        push.finish(function () {
            //            console.log('finish successfully called');
            //        });
            //    });

            //    push.on('error', function (e) {
            //        console.log("push error");
            //    });
            //}

            //document.addEventListener("deviceready", onCordovaReady, false);

            //function onCordovaReady() {

            //        /// רישום פוש
            //        alert("לפני אינישילייז");
            //        var push = PushNotification.init({
            //            "android": {
            //                "senderID": "336880743356"
            //            },
            //            "ios": {
            //                "alert": "true",
            //                "badge": "true",
            //                "sound": "true",
            //                "senderID": "336880743356",
            //                "gcmSandbox": true
            //            },
            //            "windows": {}
            //        });

            //    alert("אחרי אינישילייז");
            //    push.on('registration', function (res) {

            //        alert("אני בפנייי");
            //        //res.registrationId;   // hold   device number in GCM
            //        //res.platform;
            //        alert(res.registrationId + "   ");// + res.platform);
            //        //here we will make ajax call to our server for
            //        // storing the registrationId in DB.
            //        // we will add to the call:
            //        // user platform (ios, android etc..) and more data
            //        //for further use

            //        $.ajax({
            //            dataType: "json",
            //            url: generic + "SavePushInfo",
            //            contentType: "application/json; charset=utf-8",
            //            type: "POST",
            //            //data: JSON.stringify({ userId: UserId, deviceString: res.registrationId, platform: res.platform }),
            //            data: JSON.stringify({ userId: "302921481", deviceString: res.registrationId, platform: res.platform }),
            //            success: function (data) {

            //                var isUser = JSON.parse(data.d);
            //            },
            //            error: function (err) { }
            //        });

            //    });
            //}





        }
    </script>

    <script>
        function ConRegister() {

            //לתקן!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
            //location.href = "index2.html#CompleteRegisterPage";

            location.href = "Login-Taramti.html#CompleteRegisterPage";
        };

        /// <summary>וידוא כל השדות</summary>
        function FirstRegisterUser() {

            var id = $("#Userid").val();
            var first = $("#UserFirstName").val();
            var last = $("#UserLastName").val();
            var mail = $("#Usermail").val();
            var pass = $("#UserPass").val();
            var pass2 = $("#UserPass2").val();
            //alert(id + " " + first + " " + last + " " + mail + " " + pass + " " + pass2 + " ");
            if ($("#UserPassNew").val() == $("#UserPassNew2").val()) {
                $.ajax({
                    dataType: "json",
                    url: generic + "AddUser",
                    contentType: "application/json; charset=utf-8",
                    type: "POST",
                    data: JSON.stringify({ mail: mail, pass: pass2, first: first, last: last, id: id }),
                    success: function (data) {

                        var isUser = JSON.parse(data.d);

                        if (isUser == "True") {
                            alert("המשתמש נוצר בהצלחה! אנא התחבר למערכת");
                        }
                        else {
                            alert("המשתמש כבר קיים במערכת, אנא התחברו מחדש");
                        }
                        location.href = "Login-Taramti.html#LoginPage";
                    },
                    error: function (err) { }
                });
            }
        }

        /// <summary>ולידטוריםםםם</summary>
        function RegisterUser() {

            var id = $("#UserId").val();
            var phone = $("#UserPhon").val();
            var city = $("#UserCity").val();
            var street = $("#UserStreet").val();
            var num = $("#UserHomeNum").val();

            if (city != -1) {
                $.ajax({
                    dataType: "json",
                    url: generic + "AddUserAllInfo",
                    contentType: "application/json; charset=utf-8",
                    type: "POST",
                    data: JSON.stringify({ id: id, phone: phone, city: city, street: street, num: num }),
                    success: function (data) {

                        var isUser = JSON.parse(data.d);

                        if (isUser == true) {
                            alert("המשתמש נוצר בהצלחה! אנא התחבר למערכת");
                        }
                        else {
                            alert("המשתמש כבר קיים במערכת, אנא התחברו מחדש");
                        }
                        location.href = "Login-Taramti.html#LoginPage";
                    },
                    error: function (err) { }
                });
            }
            else {
                alert("אנא בחר עיר מגורים");
            }
        }

        function SendMailPass() {
            var userID = $("#UserId").val();
            var userMail = $("#UserMailForgot").val();
            $.ajax({
                dataType: "json",
                url: generic + "CheckValidUser",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                async: false,
                data: JSON.stringify({ id: userID, mail: userMail }),
                success: function (data) {

                    var res = JSON.parse(data.d);
                    if (res) {
                        alert("סיסמתך אופסה בהצלחה. אנא בדוק את תיבת הדואר שלך לפרטי ההתחברות החדשים");
                        location.href = "Login-Taramti.html#LoginPage";
                    }
                    else {
                        alert("ת.ז או אימייל שגויים, הזן ת.ז ואימייל לצורך איפוס סיסמה");
                        location.href = "Login-Taramti.html#ForgotPassPage";
                    }
                },
                error: function (err) {

                }
            });

        }

        function RestorePass() {
            if ($("#UserPassNew").val() == $("#UserPassNew2").val()) {
                var id = $("#UserIdRestore").val();
                var pass = $("#UserPassNew").val();

                $.ajax({
                    dataType: "json",
                    url: generic + "ChangePass",
                    contentType: "application/json; charset=utf-8",
                    type: "POST",
                    data: JSON.stringify({ id: id, newPass: pass }),
                    success: function (data) {

                        var isUser = JSON.parse(data.d);

                        alert("סיסמתך שונתה בהצלחה");
                        location.href = "Login-Taramti.html#LoginPage";
                    },
                    error: function (err) { }
                });
            }
            else {
                alert("הסיסמאות אינן תואמות!");
            }

        }

        function CityList() {
            $.ajax({
                dataType: "json",
                url: generic + "GetAllCities",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({}),
                success: function (data) {

                    var Cities = JSON.parse(data.d);

                    if (Cities[0] != null) {
                        for (var i = 0; i < Cities.length; i++) {
                            var opt = '';
                            opt += '<option value="' + Cities[i].CityCode + '">' + Cities[i].CityName + '</option>';
                            $("#UserCity").append(opt);
                        }
                    }
                },
                error: function (err) { }
            });
        }
    </script>

</body>
</html>